<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>数据库及MySQL | Likexiao Blogs</title>

    <meta name="description" content="&lt;h1 id=&#34;数据库及MySQL&#34;&gt;&lt;a href=&#34;#数据库及MySQL&#34; class=&#34;headerlink&#34; title=&#34;数据库及MySQL&#34;&gt;&lt;/a&gt;数据库及MySQL&lt;/h1&gt;&lt;h2 id=&#34;数据库&#34;&gt;&lt;a href=&#34;#数据库&#34; class=&#34;headerlink&#34; title=&#34;数据库&#34;&gt;&lt;/a&gt;数据库&lt;/h2&gt;&lt;h3 id=&#34;数据库范式&#34;&gt;&lt;a href=&#34;#数据库范式&#34; class=&#34;headerlink&#34; title=&#34;数据库范式&#34;&gt;&lt;/a&gt;数据库范式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;第一范式 : &lt;strong&gt;是数据库最基本的要求&lt;/strong&gt;,属性不能再被分割&lt;/li&gt;
&lt;li&gt;第二范式 : 消除非主属性对于码的部分函数依赖&lt;/li&gt;
&lt;li&gt;第三范式 : 消除了非主属性对于码的函数依赖&lt;/li&gt;
&lt;/ul&gt;">
    <meta name="keywords" content="">

    

    <meta property="og:locale" content="zh-CN,en,default" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "数据库及MySQL | Likexiao Blogs"  />
    <meta property="og:description" content= "&lt;h1 id=&#34;数据库及MySQL&#34;&gt;&lt;a href=&#34;#数据库及MySQL&#34; class=&#34;headerlink&#34; title=&#34;数据库及MySQL&#34;&gt;&lt;/a&gt;数据库及MySQL&lt;/h1&gt;&lt;h2 id=&#34;数据库&#34;&gt;&lt;a href=&#34;#数据库&#34; class=&#34;headerlink&#34; title=&#34;数据库&#34;&gt;&lt;/a&gt;数据库&lt;/h2&gt;&lt;h3 id=&#34;数据库范式&#34;&gt;&lt;a href=&#34;#数据库范式&#34; class=&#34;headerlink&#34; title=&#34;数据库范式&#34;&gt;&lt;/a&gt;数据库范式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;第一范式 : &lt;strong&gt;是数据库最基本的要求&lt;/strong&gt;,属性不能再被分割&lt;/li&gt;
&lt;li&gt;第二范式 : 消除非主属性对于码的部分函数依赖&lt;/li&gt;
&lt;li&gt;第三范式 : 消除了非主属性对于码的函数依赖&lt;/li&gt;
&lt;/ul&gt;" />
    <meta property="og:url" content="https://likexiao.github.io/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/9.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8AMySQL/index.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="Likexiao" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;h1 id=&#34;数据库及MySQL&#34;&gt;&lt;a href=&#34;#数据库及MySQL&#34; class=&#34;headerlink&#34; title=&#34;数据库及MySQL&#34;&gt;&lt;/a&gt;数据库及MySQL&lt;/h1&gt;&lt;h2 id=&#34;数据库&#34;&gt;&lt;a href=&#34;#数据库&#34; class=&#34;headerlink&#34; title=&#34;数据库&#34;&gt;&lt;/a&gt;数据库&lt;/h2&gt;&lt;h3 id=&#34;数据库范式&#34;&gt;&lt;a href=&#34;#数据库范式&#34; class=&#34;headerlink&#34; title=&#34;数据库范式&#34;&gt;&lt;/a&gt;数据库范式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;第一范式 : &lt;strong&gt;是数据库最基本的要求&lt;/strong&gt;,属性不能再被分割&lt;/li&gt;
&lt;li&gt;第二范式 : 消除非主属性对于码的部分函数依赖&lt;/li&gt;
&lt;li&gt;第三范式 : 消除了非主属性对于码的函数依赖&lt;/li&gt;
&lt;/ul&gt;" />
    <meta name="twitter:title" content="数据库及MySQL | Likexiao Blogs"/>
    <meta name="twitter:description" content="&lt;h1 id=&#34;数据库及MySQL&#34;&gt;&lt;a href=&#34;#数据库及MySQL&#34; class=&#34;headerlink&#34; title=&#34;数据库及MySQL&#34;&gt;&lt;/a&gt;数据库及MySQL&lt;/h1&gt;&lt;h2 id=&#34;数据库&#34;&gt;&lt;a href=&#34;#数据库&#34; class=&#34;headerlink&#34; title=&#34;数据库&#34;&gt;&lt;/a&gt;数据库&lt;/h2&gt;&lt;h3 id=&#34;数据库范式&#34;&gt;&lt;a href=&#34;#数据库范式&#34; class=&#34;headerlink&#34; title=&#34;数据库范式&#34;&gt;&lt;/a&gt;数据库范式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;第一范式 : &lt;strong&gt;是数据库最基本的要求&lt;/strong&gt;,属性不能再被分割&lt;/li&gt;
&lt;li&gt;第二范式 : 消除非主属性对于码的部分函数依赖&lt;/li&gt;
&lt;li&gt;第三范式 : 消除了非主属性对于码的函数依赖&lt;/li&gt;
&lt;/ul&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;h1 id=&#34;数据库及MySQL&#34;&gt;&lt;a href=&#34;#数据库及MySQL&#34; class=&#34;headerlink&#34; title=&#34;数据库及MySQL&#34;&gt;&lt;/a&gt;数据库及MySQL&lt;/h1&gt;&lt;h2 id=&#34;数据库&#34;&gt;&lt;a href=&#34;#数据库&#34; class=&#34;headerlink&#34; title=&#34;数据库&#34;&gt;&lt;/a&gt;数据库&lt;/h2&gt;&lt;h3 id=&#34;数据库范式&#34;&gt;&lt;a href=&#34;#数据库范式&#34; class=&#34;headerlink&#34; title=&#34;数据库范式&#34;&gt;&lt;/a&gt;数据库范式&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;第一范式 : &lt;strong&gt;是数据库最基本的要求&lt;/strong&gt;,属性不能再被分割&lt;/li&gt;
&lt;li&gt;第二范式 : 消除非主属性对于码的部分函数依赖&lt;/li&gt;
&lt;li&gt;第三范式 : 消除了非主属性对于码的函数依赖&lt;/li&gt;
&lt;/ul&gt;",
            "author": { "@type": "Person", "name": "Likexiao" },
            "@type": "BlogPosting",
            "url": "https://likexiao.github.io/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/9.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8AMySQL/index.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "https://likexiao.github.ioundefined"
            },
            "name": "Likexiao"
            },
            "headline": "数据库及MySQL | Likexiao Blogs",
            "datePublished": "2022-06-15T13:08:10.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://likexiao.github.io/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/9.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8AMySQL/index.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    

    

    

    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎮</text></svg>">
    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = false

    </script>

<meta name="generator" content="Hexo 6.3.0"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>Likexiao Blogs</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
            </div>
            <div class="header-menu-social">
                
            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-clb3e00md000wtwtxfue8hl2c" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      数据库及MySQL
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-06-15T13:08:10.000Z" itemprop="datePublished">2022-06-15</time>
</div>

            

            

            
            <div class="article-busuanzi">
                <span id="busuanzi_value_page_pv">N</span> 人看过
            </div>
            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <h1 id="数据库及MySQL"><a href="#数据库及MySQL" class="headerlink" title="数据库及MySQL"></a>数据库及MySQL</h1><h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><h3 id="数据库范式"><a href="#数据库范式" class="headerlink" title="数据库范式"></a>数据库范式</h3><ul>
<li>第一范式 : <strong>是数据库最基本的要求</strong>,属性不能再被分割</li>
<li>第二范式 : 消除非主属性对于码的部分函数依赖</li>
<li>第三范式 : 消除了非主属性对于码的函数依赖</li>
</ul>
<span id="more"></span>

<h3 id="什么是存储过程"><a href="#什么是存储过程" class="headerlink" title="什么是存储过程?"></a>什么是存储过程?</h3><ul>
<li>是一些SQL语句的集合 , 其中加了些逻辑控制语句</li>
<li>一旦调试完成通过后就能稳定运行</li>
<li>比单纯的SQL更快速 , 因为存储过程是经过预编译的</li>
</ul>
<p>缺点 : 难以调试和拓展 , 更没有拓展性</p>
<h3 id="删除语句-drop、delete-与-truncate-区别？"><a href="#删除语句-drop、delete-与-truncate-区别？" class="headerlink" title="(删除语句)drop、delete 与 truncate 区别？"></a>(删除语句)drop、delete 与 truncate 区别？</h3><ul>
<li>drop(丢弃数据): <code>drop table 表名</code> ，直接将表都删除掉，在删除表的时候使用。</li>
<li>truncate (清空数据) : <code>truncate table 表名</code> ，只删除表中的数据，再插入数据的时候自增长 id 又从 1 开始，在清空表中数据的时候使用。</li>
<li>delete（删除数据） : <code>delete from 表名 where 列名=值</code>，删除某一行的数据，如果不加 where 子句和<code>truncate table 表名</code>作用类似。</li>
</ul>
<h3 id="数据库设计通常分为哪几步"><a href="#数据库设计通常分为哪几步" class="headerlink" title="数据库设计通常分为哪几步?"></a>数据库设计通常分为哪几步?</h3><ol>
<li><strong>需求分析</strong> : 分析用户的需求，包括数据、功能和性能需求。</li>
<li><strong>概念结构设计</strong> : 主要采用 E-R 模型进行设计，包括画 E-R 图。</li>
<li><strong>逻辑结构设计</strong> : 通过将 E-R 图转换成表，实现从 E-R 模型到关系模型的转换。</li>
<li><strong>物理结构设计</strong> : 主要是为所设计的数据库选择合适的存储结构和存取路径。</li>
<li><strong>数据库实施</strong> : 包括编程、测试和试运行</li>
<li><strong>数据库的运行和维护</strong> : 系统的运行与数据库的日常维护。</li>
</ol>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h3><p>limit函数,有两个参数,第一个是页数,第二个是每页的数量</p>
<p><em><em>sql写入页数 &#x3D; (页数 - 1)</em> 每页数量</em>*</p>
<p>模糊查找( % 和 * )</p>
<ol>
<li><p>作用不同</p>
<ul>
<li>*通配符的作用是用来匹配所有结果集。</li>
<li>%通配符的作用是用来替代一个或多个字符。</li>
</ul>
</li>
<li><p>优先级不同</p>
<p>*通配符的优先级比%通配符高，在同一条sql语句中，优先执行。</p>
</li>
<li><p>针对范围不同</p>
<ul>
<li>*通配符的针对范围为一条记录的所有字段。</li>
<li>%通配符的针对范围为一条记录的单个字段。</li>
</ul>
</li>
</ol>
<h3 id="MyISAM和InnoDB的区别"><a href="#MyISAM和InnoDB的区别" class="headerlink" title="MyISAM和InnoDB的区别"></a>MyISAM和InnoDB的区别</h3><ul>
<li>行级锁</li>
<li>外键</li>
<li>事务</li>
<li>数据库异常崩溃后的安全恢复 : MySQL用redo log 来保证</li>
</ul>
<p><strong>[拓展]</strong></p>
<ul>
<li>MySQL InnoDB 引擎使用 <strong>redo log(重做日志)</strong> 保证事务的<strong>持久性</strong>，使用 <strong>undo log(回滚日志)</strong> 来保证事务的<strong>原子性</strong>。</li>
<li>MySQL InnoDB 引擎通过 <strong>锁机制</strong>、<strong>MVCC</strong> 等手段来保证事务的隔离性（ 默认支持的隔离级别是 <strong><code>REPEATABLE-READ</code></strong> ）。</li>
<li>保证了事务的持久性、原子性、隔离性之后，一致性才能得到保障。</li>
</ul>
<h3 id="锁机制与-InnoDB-锁算法"><a href="#锁机制与-InnoDB-锁算法" class="headerlink" title="锁机制与 InnoDB 锁算法"></a>锁机制与 InnoDB 锁算法</h3><p><strong>MyISAM 和 InnoDB 存储引擎使用的锁：</strong></p>
<ul>
<li>MyISAM 采用表级锁(table-level locking)。</li>
<li>InnoDB 支持行级锁(row-level locking)和表级锁,默认为行级锁</li>
</ul>
<p><strong>表级锁和行级锁对比：</strong></p>
<ul>
<li><strong>表级锁：</strong> MySQL 中锁定 <strong>粒度最大</strong> 的一种锁，对当前操作的整张表加锁，实现简单，资源消耗也比较少，加锁快，不会出现死锁。其锁定粒度最大，触发锁冲突的概率最高，并发度最低，MyISAM 和 InnoDB 引擎都支持表级锁。</li>
<li><strong>行级锁：</strong> MySQL 中锁定 <strong>粒度最小</strong> 的一种锁，只针对当前操作的行进行加锁。 行级锁能大大减少数据库操作的冲突。其加锁粒度最小，并发度高，但加锁的开销也最大，加锁慢，会出现死锁。</li>
</ul>
<p><strong>InnoDB 存储引擎的锁的算法有三种：</strong></p>
<ul>
<li>Record lock：记录锁，单个行记录上的锁</li>
<li>Gap lock：间隙锁，锁定一个范围，不包括记录本身</li>
<li>Next-key lock：record+gap 临键锁，锁定一个范围，包含记录本身</li>
</ul>
<h3 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h3><p><strong>开启查询缓存后在同样的查询条件以及数据情况下，会直接在缓存中返回结果</strong>。</p>
<p><strong>缓存虽然能够提升数据库的查询性能，但是缓存同时也带来了额外的开销，每次查询后都要做一次缓存操作，失效后还要销毁。</strong> 因此，开启查询缓存要谨慎，尤其对于写密集的应用来说更是如此。</p>
<h3 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h3><p><strong>是逻辑上的一组操作，要么都执行，要么都不执行。</strong></p>
<h4 id="何为-ACID-特性呢？"><a href="#何为-ACID-特性呢？" class="headerlink" title="何为 ACID 特性呢？"></a>何为 ACID 特性呢？</h4><ol>
<li><strong>原子性</strong>（<code>Atomicity</code>） ： 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；</li>
<li><strong>一致性</strong>（<code>Consistency</code>）： 执行事务前后，数据保持一致，例如转账业务中，无论事务是否成功，转账者和收款人的总额应该是不变的；</li>
<li><strong>隔离性</strong>（<code>Isolation</code>）： 并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的；</li>
<li><strong>持久性</strong>（<code>Durability</code>）： 一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。</li>
</ol>
<h4 id="并发事务带来哪些问题"><a href="#并发事务带来哪些问题" class="headerlink" title="并发事务带来哪些问题?"></a>并发事务带来哪些问题?</h4><ul>
<li><strong>脏读（Dirty read）:</strong> 当一个事务正在访问数据并且对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据。因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是“脏数据”，依据“脏数据”所做的操作可能是不正确的。</li>
<li><strong>丢失修改（Lost to modify）</strong></li>
<li><strong>不可重复读（Unrepeatable read）:</strong> 指在一个事务内多次读同一数据。在这个事务还没有结束时，另一个事务也访问该数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读取的数据可能不太一样。这就发生了在一个事务内两次读到的数据是不一样的情况，因此称为不可重复读。</li>
<li><strong>幻读（Phantom read）:</strong> 幻读与不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，第一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称为幻读。</li>
</ul>
<h4 id="事务隔离级别有哪些"><a href="#事务隔离级别有哪些" class="headerlink" title="事务隔离级别有哪些?"></a>事务隔离级别有哪些?</h4><ul>
<li><strong>READ-UNCOMMITTED(读取未提交)：</strong> 最低的隔离级别，允许读取尚未提交的数据变更，<strong>可能会导致脏读、幻读或不可重复读</strong>。</li>
<li><strong>READ-COMMITTED(读取已提交)：</strong> 允许读取并发事务已经提交的数据，<strong>可以阻止脏读，但是幻读或不可重复读仍有可能发生</strong>。</li>
<li><strong>REPEATABLE-READ(可重复读)：</strong> 对同一字段的多次读取结果都是一致的，除非数据是被本身事务自己所修改，<strong>可以阻止脏读和不可重复读，但幻读仍有可能发生</strong>。</li>
<li><strong>SERIALIZABLE(串行化)：</strong> 最高的隔离级别，完全服从 ACID 的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，<strong>该级别可以防止脏读、不可重复读以及幻读</strong>。</li>
</ul>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p><strong>索引是一种用于快速查询和检索数据的数据结构。常见的索引结构有: B 树， B+树和 Hash。</strong></p>
<h4 id="索引的优缺点"><a href="#索引的优缺点" class="headerlink" title="索引的优缺点"></a>索引的优缺点</h4><p><strong>优点</strong> ：</p>
<ul>
<li>使用索引可以大大加快数据的检索速度（大大减少检索的数据量）, 这也是创建索引的最主要的原因。</li>
<li>通过创建唯一性索引，可以保证数据库表中每一行数据的唯一性。</li>
</ul>
<p><strong>缺点</strong> ：</p>
<ul>
<li>创建索引和维护索引需要耗费许多时间。当对表中的数据进行增删改的时候，如果数据有索引，那么索引也需要动态的修改，会降低 SQL 执行效率。</li>
<li>索引需要使用物理文件存储，也会耗费一定空间。</li>
</ul>
<h4 id="索引的底层数据结构"><a href="#索引的底层数据结构" class="headerlink" title="索引的底层数据结构"></a>索引的底层数据结构</h4><ul>
<li><p>Hash</p>
<p><strong>为什么MySQL 没有使用其作为索引的数据结构呢？</strong></p>
<p><strong>1.Hash 冲突问题</strong> ：我们上面也提到过Hash 冲突了，不过对于数据库来说这还不算最大的缺点。</p>
<p><strong>2.Hash 索引不支持顺序和范围查询(Hash 索引不支持顺序和范围查询是它最大的缺点：</strong> 假如我们要对表中的数据进行排序或者进行范围查询，那 Hash 索引可就不行了。</p>
</li>
<li><p>B &amp; B+</p>
<p><strong>B 树&amp; B+树两者有何异同呢？</strong></p>
<ul>
<li>B 树的所有节点既存放键(key) 也存放 数据(data)，而 B+树只有叶子节点存放 key 和 data，其他内节点只存放 key。</li>
<li>B 树的叶子节点都是独立的;B+树的叶子节点有一条引用链指向与它相邻的叶子节点。</li>
<li>B 树的检索的过程相当于对范围内的每个节点的关键字做二分查找，可能还没有到达叶子节点，检索就结束了。而 B+树的检索效率就很稳定了，任何查找都是从根节点到叶子节点的过程，叶子节点的顺序检索很明显。</li>
</ul>
</li>
</ul>
<h4 id="索引类型"><a href="#索引类型" class="headerlink" title="索引类型"></a>索引类型</h4><ul>
<li>主键索引 : 数据表的主键使用的就是主键索引</li>
<li>二级索引(辅助索引) : <strong>因为二级索引的叶子节点存储的数据是主键。也就是说，通过二级索引，可以定位主键的位置。</strong><ul>
<li><strong>唯一索引(Unique Key)</strong> ：唯一索引也是一种约束。<strong>唯一索引的属性列不能出现重复的数据，但是允许数据为 NULL，一张表允许创建多个唯一索引。</strong> 建立唯一索引的目的大部分时候都是为了该属性列的数据的唯一性，而不是为了查询效率。</li>
<li><strong>普通索引(Index)</strong> ：<strong>普通索引的唯一作用就是为了快速查询数据，一张表允许创建多个普通索引，并允许数据重复和 NULL。</strong></li>
<li><strong>前缀索引(Prefix)</strong> ：前缀索引只适用于字符串类型的数据。前缀索引是对文本的前几个字符创建索引，相比普通索引建立的数据更小， 因为只取前几个字符。</li>
<li><strong>全文索引(Full Text)</strong> ：全文索引主要是为了检索大文本数据中的关键字的信息，是目前搜索引擎数据库使用的一种技术。Mysql5.6 之前只有 MYISAM 引擎支持全文索引，5.6 之后 InnoDB 也支持了全文索引。</li>
</ul>
</li>
</ul>
<h4 id="聚簇索引与非聚簇索引"><a href="#聚簇索引与非聚簇索引" class="headerlink" title="聚簇索引与非聚簇索引"></a>聚簇索引与非聚簇索引</h4><p><strong>聚集索引即索引结构和数据一起存放的索引。主键索引属于聚集索引。</strong></p>
<h5 id="聚集索引的优点"><a href="#聚集索引的优点" class="headerlink" title="聚集索引的优点"></a>聚集索引的优点</h5><p>聚集索引的查询速度非常的快，因为整个 B+树本身就是一颗多叉平衡树，叶子节点也都是有序的，定位到索引的节点，就相当于定位到了数据。</p>
<h5 id="聚集索引的缺点"><a href="#聚集索引的缺点" class="headerlink" title="聚集索引的缺点"></a>聚集索引的缺点</h5><ol>
<li><strong>依赖于有序的数据</strong> ：因为 B+树是多路平衡树，如果索引的数据不是有序的，那么就需要在插入时排序，如果数据是整型还好，否则类似于字符串或 UUID 这种又长又难比较的数据，插入或查找的速度肯定比较慢。</li>
<li><strong>更新代价大</strong> ： 如果对索引列的数据被修改时，那么对应的索引也将会被修改，而且聚集索引的叶子节点还存放着数据，修改代价肯定是较大的，所以对于主键索引来说，主键一般都是不可被修改的</li>
</ol>
<p><strong>非聚集索引即索引结构和数据分开存放的索引 , 二级索引属于非聚集索引。</strong></p>
<p>非聚集索引的叶子节点并不一定存放数据的指针，因为二级索引的叶子节点就存放的是主键，根据主键再回表查数据。</p>
<h5 id="非聚集索引的优点"><a href="#非聚集索引的优点" class="headerlink" title="非聚集索引的优点"></a>非聚集索引的优点</h5><ul>
<li><strong>更新代价比聚集索引要小</strong></li>
</ul>
<h5 id="非聚集索引的缺点"><a href="#非聚集索引的缺点" class="headerlink" title="非聚集索引的缺点"></a>非聚集索引的缺点</h5><ol>
<li>跟聚集索引一样，非聚集索引也依赖于有序的数据</li>
<li><strong>可能会二次查询(回表)</strong> :这应该是非聚集索引最大的缺点了。 当查到索引对应的指针或主键后，可能还需要根据指针或主键再到数据文件或表中查询。</li>
</ol>
<h5 id="非聚集索引一定回表查询吗-覆盖索引"><a href="#非聚集索引一定回表查询吗-覆盖索引" class="headerlink" title="非聚集索引一定回表查询吗(覆盖索引)?"></a>非聚集索引一定回表查询吗(覆盖索引)?</h5><p><strong>非聚集索引不一定回表查询。</strong></p>
<p>主键索引本身的 key 就是主键，查到返回就行了。这种情况就称之为覆盖索引了。</p>
<p>例如 : <code>SELECT id FROM table WHERE id=1;</code></p>
<h4 id="覆盖索引"><a href="#覆盖索引" class="headerlink" title="覆盖索引"></a>覆盖索引</h4><p><strong>覆盖索引即需要查询的字段正好是索引的字段，那么直接根据该索引，就可以查到数据了， 而无需回表查询。</strong></p>
<h4 id="创建索引的注意事项"><a href="#创建索引的注意事项" class="headerlink" title="创建索引的注意事项"></a>创建索引的注意事项</h4><ul>
<li>选择合适的字段<ul>
<li>不为NULL的字段 , 如果需要 , 使用0 , 1 , true , false来代替</li>
<li>被频繁查询的字段</li>
<li>被作为条件查询的字段</li>
<li>频繁需要排序的字段</li>
<li>频繁连接的字段</li>
</ul>
</li>
<li>被频繁更新的字段应谨慎建立索引</li>
<li>尽量考虑联合索引而非单列索引</li>
<li>尽量避免冗余索引<ul>
<li>能够命中索引(a, b)就肯定能命中索引(a) ，那么索引(a)就是冗余索引</li>
</ul>
</li>
</ul>
<h3 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h3><p>一种多版本并发控制机制</p>
<h4 id="解决什么问题"><a href="#解决什么问题" class="headerlink" title="解决什么问题?"></a>解决什么问题?</h4><ul>
<li>大多数的MYSQL事务型存储引擎,如InnoDB都不使用一种简单的行锁机制.事实上,他们都和MVCC–多版本并发控制来一起使用</li>
<li>锁机制可以控制并发操作,但是其系统开销较大,而MVCC可以在大多数情况下代替行级锁,使用MVCC,能降低其系统开销</li>
</ul>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>通过保存数据在某个时间点的快照来实现的. 不同存储引擎的MVCC. 不同存储引擎的MVCC实现是不同的,典型的有乐观并发控制和悲观并发控制</p>
<p><strong>快照读</strong></p>
<p>如果读取的行正在执行 <code>DELETE</code> 或 <code>UPDATE</code> 操作，这时读取操作不会去等待行上锁的释放。相反地，<code>InnoDB</code> 存储引擎会去读取行的一个快照数据，对于这种读取历史数据的方式，我们叫它快照读</p>
<p><strong>锁定读</strong></p>
<p>如果执行的是下列语句，就是锁定读</p>
<ul>
<li><p><code>select ... lock in share mode</code></p>
</li>
<li><p><code>select ... for update</code></p>
</li>
<li><p><code>insert</code>、<code>update</code>、<code>delete</code> 操作</p>
<p>在锁定读下，读取的是数据的最新版本</p>
</li>
</ul>
<h2 id="MySQL对于千万级的数据库或者大表怎么处理"><a href="#MySQL对于千万级的数据库或者大表怎么处理" class="headerlink" title="MySQL对于千万级的数据库或者大表怎么处理?"></a>MySQL对于千万级的数据库或者大表怎么处理?</h2><p>第一优化你的sql和索引；</p>
<p>第二加缓存，memcached,redis；</p>
<p>第三以上都做了后，还是慢，就做主从复制或主主复制，读写分离，可以在应用层做，效率高，也可以用三方工具</p>
<p>第四如果以上都做了还是慢，不要想着去做切分，mysql自带分区表，先试试这个</p>
<p>第五如果以上都做了，那就先做垂直拆分，其实就是根据你模块的耦合度，将一个大的系统分为多个小的系统，也就是分布式系统</p>
<p>第六才是水平切分，针对数据量大的表，这一步最麻烦，最能考验技术水平，要选择一个合理的sharding key,为了有好的查询效率，表结构也要改动，做一定的冗余，应用也要改，sql中尽量带sharding key，将数据定位到限定的表上去查，而不是扫描全部的表；</p>
<h3 id="InnoDB-对-MVCC-的实现"><a href="#InnoDB-对-MVCC-的实现" class="headerlink" title="InnoDB 对 MVCC 的实现"></a>InnoDB 对 MVCC 的实现</h3><p><code>MVCC</code> 的实现依赖于：<strong>隐藏字段、Read View、undo log</strong>。在内部实现中，<code>InnoDB</code> 通过数据行的 <code>DB_TRX_ID</code> 和 <code>Read View</code> 来判断数据的可见性，如不可见，则通过数据行的 <code>DB_ROLL_PTR</code> 找到 <code>undo log</code> 中的历史版本。每个事务读到的数据版本可能是不一样的，在同一个事务中，用户只能看到该事务创建 <code>Read View</code> 之前已经提交的修改和该事务本身做的修改</p>

        </div>

    </div>

    

    

    

    

    

    
<nav class="article-nav">
  
    <a href="/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/8.Linux%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-caption">下一篇</div>
      <div class="article-nav-title">
        
          Linux操作
        
      </div>
    </a>
  
  
    <a href="/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/7.%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">操作系统</div>
    </a>
  
</nav>


    <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=数据库及MySQL - Likexiao Blogs&url=https%3A%2F%2Flikexiao.github.io%2F2022%2F06%2F15%2F%25E5%2585%25AB%25E8%2582%25A1%25E6%2596%2587%2F9.%25E6%2595%25B0%25E6%258D%25AE%25E5%25BA%2593%25E5%258F%258AMySQL%2F">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=数据库及MySQL - Likexiao Blogs&u=https%3A%2F%2Flikexiao.github.io%2F2022%2F06%2F15%2F%25E5%2585%25AB%25E8%2582%25A1%25E6%2596%2587%2F9.%25E6%2595%25B0%25E6%258D%25AE%25E5%25BA%2593%25E5%258F%258AMySQL%2F">
            <ion-icon name="logo-facebook"></ion-icon>
        </a>
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=数据库及MySQL - Likexiao Blogs&url=https://likexiao.github.io/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/9.%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8AMySQL/&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    </section>

</article>
















<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</div>
                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>Categories</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%B9%E8%AF%9D/">对话</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A4%E8%AF%86/" rel="tag">认识</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/2022/11/30/dp-core-6/">设计模式六大原则详解</a>
          </li>
        
          <li>
            <a href="/2022/10/11/Docker%E5%AE%89%E8%A3%85%20Redis%E5%AE%B9%E5%99%A8/">Docker 安装 Redis 容器</a>
          </li>
        
          <li>
            <a href="/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/1.Java%E5%9F%BA%E7%A1%80/">Java基础</a>
          </li>
        
          <li>
            <a href="/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/10.Spring/">Spring</a>
          </li>
        
          <li>
            <a href="/2022/06/15/%E5%85%AB%E8%82%A1%E6%96%87/11.MyBatis/">MyBatis</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <!-- Please do not remove this -->
    <!-- 开源不易，请勿删除 -->
    <div class="footer-wrap">
        <div class="footer-inner"> 
            Likexiao Blogs &copy; 2022<br>
            Powered By Hexo · Theme By <a href="https://linhong.me/" target="_blank">Aomori</a> · <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Github</a>
        </div>
    </div>

</footer>

<script type="module" src="https://unpkg.com/ionicons@6.0.2/dist/ionicons/ionicons.esm.js"></script>






<script src="/dist/build.js?1654266144177.js"></script>


<script src="/dist/custom.js?1654266144177.js"></script>












<!-- Baidu Analytics-->
<script type="text/javascript">
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?be7083050bcb3ab41dfb4024a26ecb0";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>

</html>